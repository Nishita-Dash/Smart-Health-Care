create table med_history(p_id integer references patient_details(p_id),pr_id integer references prescription(pr_id),med_allergy varchar(800),med_current varchar(800),med_past varchar(800),CONSTRAINT pk_medhistory PRIMARY KEY (p_id));
select * from patient_details;
select * from login_details;
select * from med_history;
select * from prescription;
select * from patient_details;
select * from test_report;
select * from doctor;
select * from appointments;
truncate med_history;
truncate test_report;
truncate prescription;
drop table med_history;
drop table prescription;
select * from doctor;

Create table prescription(pr_id integer primary key AUTO_INCREMENT,pr_status varchar(255), p_id integer REFERENCES patient_details(p_id),test_id integer REFERENCES test_report (test_id));
insert into prescription values(299999,'',0,0);
Insert into prescription values(503, 'active', 12223400 ,1209);
Insert into prescription values(568, 'inactive' ,15676700, 1850);
Insert into prescription values(679, 'active',12459367, 1244);
Insert into prescription values(1002, 'active' ,14759795, 139);
Insert into prescription values(1056, 'active',19858335, 1245);
Insert into prescription values(1003, 'inactive',18472982, 1359);
Insert into prescription values(1004, 'inactive',19934028, 1580);
Insert into prescription values(622, 'active' ,12837497, 1244);
Insert into prescription values(566, 'inactive',12883740, 1457);
Insert into prescription values(345, 'active',15644848, 1246);
use hospital;
drop table test_report;
Create table test_report(test_id integer primary key AUTO_INCREMENT,test_name varchar(255),test_doc varchar(255),ts_id varchar(255) references tests(ts_id),test_category varchar(255), p_id integer references patient_details(p_id));
insert into test_report values(399999,'','',0,'',0);

create table payments(
pay_id integer primary key auto_increment,
pay_amount float,
pay_status varchar(255),
pay_date varchar(255),
pay_method varchar(255),
p_id integer references patient_details(p_id)
);
select * from payments;
drop table payments;
insert into payments values (499999,0,'','','',0);
create table doctor(d_id integer primary key auto_increment,d_name varchar(255),d_gender varchar(255),d_specialization varchar(255),d_phone integer,d_zip integer,d_age integer,d_salary float,d_street_name varchar(255),br_id integer,l_id integer,d_city varchar(255),d_state varchar(255),foreign key (br_id) references branches(br_id),foreign key (l_id) references login_details(l_id));
select * from doctor;
select * from branches;
truncate doctor;
insert into doctor values(599999,'','','',0,0,0,0,'',101,100001,'','');
insert into login_details values(9000,'ria','riachak','doctor');
insert into login_details values(9001,'mitali','manemane','doctor');
insert into login_details values(9002,'rohit','roshet','doctor');
insert into login_details values(9003,'anurag','bhowmickme','doctor');
insert into login_details values(9004,'farhan12','khanfarhan','doctor');

drop table appointments;
create table appointments(app_id integer primary key auto_increment,app_time time,app_date date,descp varchar(1000),p_id integer references patient_details(p_id),d_id integer references doctor(d_id));



select * from branches;
insert into appointments (app_id) values(699999);
select * from appointments;
select * from test_report;
select * from insurance;
select * from inventory;
Create table insurance(ins_id integer primary key auto_increment,p_id integer REFERENCES patient_details(p_id),ins_name varchar(255),ins_category varchar(255));


insert into insurance values(7889,200000,'Birla Life insurance','platinum') ;
insert into insurance values(1438,200001,'SBI life insurance','gold')   ; 
insert into insurance values (1223,200003,'Excite life insurance','gold');

create table medicine(med_id integer primary key auto_increment ,med_name varchar(255) ,med_status varchar(255),med_price float,med_category varchar(255),br_id integer references branches(br_id));

insert into medicine values(1452,'avomine','available',15,'nausea',101);
insert into medicine values(1992,'keraglo','unavailable',200,'supplement',102);
insert into medicine values(1765,'dart','available',70,'painkiller',103);
insert into medicine values(1993,'adderall','available',100,'ADHD',102);
insert into medicine values(1578,'acetaminophen','available',150,'painkiller',104);
insert into medicine values(1094,'ampicillin','available',59,'bacterial infection',103);
insert into medicine values(1286,' crocin','unavailable', 29 ,'headache',106);
insert into medicine values(1568,'nise','available',23 ,'body pains',105);
insert into medicine values(1123,'dolo','available', 65,'fever',101);
insert into medicine values(1679,'dsr', 'available' ,20 ,'diabetes',106);

select d_id from doctors where d_id not in( select d_id from doctors where app_time=time and app_date=date);
select d_id from doctor where d_id not in (select d_id from appointments where app_time="23:30:00" and app_date="2020-11-14" ) and d_id in (select d_id from doctor where d_specialization="gynaecologist");
select d_id from doctor where d_specialization="gynaecologist" and d_id not in (select d_id from appointments where app_time="23:30:00" and app_date="2020-11-14" )  ;
select d_id from doctor where d_id in (  select d_id from appointments where app_time<>"23:30:00" and app_date<>"2020-11-14" and d_id  in (select d_id from doctor where d_specialization="gynaecologist") );
select d_id from appointments where app_time<>"23:30:00" and app_date<>"2020-11-14";
select * from medicine;
select * from doctor where d_specialization='gynaecologist';
select * from doctor where d_id not in(select d_id from appointments where app_time='23:30:00' and app_date='2020-11-14');
select * from appointments;
select * from doctor;
drop table doctor;
update appointments set d_id=600002 where app_id=700001;
create table doctor
(
d_id integer primary key auto_increment,
d_name varchar(255),
d_gender varchar(255),
d_specialization varchar(255),
d_phone bigint,
d_zip integer,
d_age integer,
d_salary float,
d_street_name varchar(255),
br_id integer,
l_id integer,
d_city varchar(255),
d_state varchar(255),
foreign key (br_id) references branches(br_id),
foreign key (l_id) references login_details(l_id)
);
insert into doctor (d_id) values(599999);
Insert into doctor values ( 600001, 'ria chakroborty','female','cardiologist',9903326511,112345,35,300000,'shar colony',101,9000,'agra','uttar pradesh');
Insert into doctor values ( 600002,'mitali mane','female','gynaecologist',9903344311,556789,45,350000,'new sama road',102,9001,'kolkata','west bengal');
Insert into doctor values ( 600003,'rohit shetty','male','paediatrician',8840023467, 990006,38,200000,'merculus road',103,9002,'alappuzha','kerala');
Insert into doctor values ( 600004, 'anurag bhowmick','male','radiologist',1123341234,541220,42,250000,'kulfi circle',104,9003,'amritsar','punjab');
Insert into doctor values ( 600005,'farhan khan','male','endocrinologist',9008876566,189209,39,260000,'chidiya circle',105,9004,'vijayawada','andhra pradesh');
Insert into doctor values ( 600006,'farhana khan','female','gynaecologist',900887600,189200,70,260000,'chidiya circle',105,9004,'vijayawada','andhra pradesh');

create database hospital;
use hospital;
create table login_details(l_id integer primary key AUTO_INCREMENT, l_usern varchar(255),l_pass varchar(255),l_category varchar(255));

insert into login_details values (99999,'','','');
insert into login_details (l_usern,l_pass,l_category) values ('kjanf','kjfn','lmalk');
truncate table login_details;
select * from login_details;

create table branches(br_id integer primary key, br_city varchar(255),br_state  varchar(255));
Insert into branches  values(101,'agra','uttar pradesh');
Insert into branches values (102,'kolkata','west bengal');
Insert into branches values (103,'alappuzha','kerala');
Insert into branches values(104,'amritsar','punjab');
Insert into branches values (105,'vijayawada','andhra pradesh');
Insert into branches values (106,'chennai','tamil nadu');
Insert into branches values (107,'vadodara','gujarat');
Insert into branches values (108,'bhubaneswar','orissa'); 
Insert into branches values (109,'guwahati','assam');
Insert into branches values(110,'gurgaon','haryana'); 


insert into patient_details (p_id)values(199999);


******************************************************
use hospital;
select * from login_details;
select * from patient_details;
truncate login_details;
truncate patient_details;
insert into login_details values (99999,'','','');
insert into patient_details values(199999,'',0 ,0 ,'','',0,'',0,0,'');
select type(l_usern) from login_details where l_usern='nishi';
create table med_history (med_allergy varchar(500),med_past varchar(800) , med_current varchar(500),p_id integer references patient_details(p_id), pr_id integer  );
create table inventory(eq_id integer primary key,eq_name varchar(255),eq_status varchar(255),eq_no integer,br_id integer references branches(br_id));
insert into inventory values(201,'syringe','available',20,302);
insert into inventory values(202,'x-ray','unavailable',4,305);
insert into inventory values(206,'Ultrasonography machine','available',2,303);
insert into inventory values(209,'CT scan','unavailable',1,303);
insert into inventory values(304,'test tubes','available',300,301);
Insert into inventory values (244,'glucometer','unavailable',6,306);
Insert into inventory values (546,'radiometer','available',8,305);
Insert into inventory values (789,'pneumograph','available',10,301);
Insert into inventory values (290,'Sterilizer','available',5,308);
Insert into inventory values (126,'handle-o-meter','unavailable',5,310);

create table tests(ts_id varchar(255) primary key,ts_name varchar(255),ts_available varchar(255),eq_id integer references inventory(eq_id));
Insert into tests values('t01','blood test','available',301);
Insert into tests values('t06','biopse','not available',302);
Insert into tests values('t12','ct scan','available',209);
Insert into tests values('t64','x-ray','available',202);
Insert into tests values('t57','polymerase chain reaction','not available',306);
Insert into tests values('t58','prothrombin time','available',305);
Insert into tests values('t63','cardiac enzymes','available',307);
Insert into tests values('t76','calcium blood test','available',308);
Insert into tests values('t20','folate test','not available',309);
Insert into tests values('t11','tsh','available',400); 

Create table test_report(test_id integer primary key,test_name varchar(255),test_doc varchar(255),ts_id varchar(255) references tests(ts_id),test_category varchar(255));
Insert into test_report values(1244,'Blood test','This is Blood test','t01','general');
Insert into test_report values(1359,'Biopsy','This is Biopsy','t06','cancer');
Insert into test_report values(1580,'CT scan','This is CT scan','t12','scan');
Insert into test_report values(1245,'X-ray','This is X-ray','t64','scan');
Insert into test_report values(1457,'polymerase chain reaction','This is polymerase chain reaction','t57','general');
Insert into test_report values(1566,'Prothrombin Time','This is Prothrombin Time','t58','general');
Insert into test_report values(1789,'Cardiac enzymes','This is Cardiac enzymes','t63','general');
Insert into test_report values(1660,'Calcium Blood Test','This is Calcium Blood test','t76','general');
Insert into test_report values(1892,'Folate test','This is Folate test scan','t20','scan');
Insert into test_report values(1123,'TSH','This is TSH','t11','thyroid');

Create table prescription(pr_id integer primary key,pr_status varchar(255), p_id integer REFERENCES patient_details(p_id),test_id integer REFERENCES test_report (test_id));
Insert into prescription values(503, 'active', 12223400 ,1209);
Insert into prescription values(568, 'inactive' ,15676700, 1850);
Insert into prescription values(679, 'active',12459367, 1244);
Insert into prescription values(1002, 'active' ,14759795, 139);
Insert into prescription values(1056, 'active',19858335, 1245);
Insert into prescription values(1003, 'inactive',18472982, 1359);
Insert into prescription values(1004, 'inactive',19934028, 1580);
Insert into prescription values(622, 'active' ,12837497, 1244);
Insert into prescription values(566, 'inactive',12883740, 1457);
Insert into prescription values(345, 'active',15644848, 1246);



